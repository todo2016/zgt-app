{"version":3,"file":"login.js","sources":["pages/login/login.vue","../../../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\r\n  <view class=\"login-container\">\r\n    <!-- È°∂ÈÉ®LogoÂå∫Âüü -->\r\n    <view class=\"logo-section\">\r\n      <image class=\"logo\" src=\"/static/logo.png\" mode=\"aspectFit\"></image>\r\n      <text class=\"app-name\">ZGTÂ∫îÁî®</text>\r\n      <text class=\"app-desc\">Êô∫ËÉΩÁÆ°ÁêÜÔºåÈ´òÊïàËøêËê•</text>\r\n    </view>\r\n    \r\n    <!-- ÁôªÂΩïË°®Âçï -->\r\n    <view class=\"form-section\">\r\n      <view class=\"form-item\">\r\n        <view class=\"input-wrapper\">\r\n          <text class=\"icon\">üë§</text>\r\n          <input \r\n            class=\"input\" \r\n            type=\"text\" \r\n            placeholder=\"ËØ∑ËæìÂÖ•Áî®Êà∑Âêç\" \r\n            v-model=\"formData.username\"\r\n            maxlength=\"20\"\r\n          />\r\n        </view>\r\n      </view>\r\n      \r\n      <view class=\"form-item\">\r\n        <view class=\"input-wrapper\">\r\n          <text class=\"icon\">üîí</text>\r\n          <input \r\n            class=\"input\" \r\n            :type=\"showPassword ? 'text' : 'password'\" \r\n            placeholder=\"ËØ∑ËæìÂÖ•ÂØÜÁ†Å\" \r\n            v-model=\"formData.password\"\r\n            maxlength=\"20\"\r\n          />\r\n          <text class=\"eye-icon\" @click=\"togglePassword\">\r\n            {{ showPassword ? 'üëÅÔ∏è' : 'üôà' }}\r\n          </text>\r\n        </view>\r\n      </view>\r\n      \r\n      <!-- ËÆ∞‰ΩèÂØÜÁ†ÅÈÄâÈ°π -->\r\n      <view class=\"remember-section\">\r\n        <label class=\"remember-item\">\r\n          <checkbox \r\n            :checked=\"formData.remember\" \r\n            @change=\"onRememberChange\"\r\n            color=\"#007AFF\"\r\n          />\r\n          <text class=\"remember-text\">ËÆ∞‰ΩèÂØÜÁ†Å</text>\r\n        </label>\r\n        <text class=\"forgot-password\" @click=\"onForgotPassword\">ÂøòËÆ∞ÂØÜÁ†ÅÔºü</text>\r\n      </view>\r\n      \r\n      <!-- ÁôªÂΩïÊåâÈíÆ -->\r\n      <button \r\n        class=\"login-btn\" \r\n        :disabled=\"!canLogin || loading\"\r\n        @click=\"handleLogin\"\r\n      >\r\n        <text v-if=\"loading\">ÁôªÂΩï‰∏≠...</text>\r\n        <text v-else>ÁôªÂΩï</text>\r\n      </button>\r\n      \r\n      <!-- ÂÖ∂‰ªñÁôªÂΩïÊñπÂºè -->\r\n      <view class=\"other-login\" v-if=\"isWechat\">\r\n        <text class=\"divider\">ÂÖ∂‰ªñÁôªÂΩïÊñπÂºè</text>\r\n        <view class=\"social-login\">\r\n          <view class=\"social-item\" @click=\"onWechatLogin\" v-if=\"isMiniProgram\">\r\n            <text class=\"social-icon\">üí¨</text>\r\n            <text class=\"social-text\">ÂæÆ‰ø°ÁôªÂΩï</text>\r\n          </view>\r\n          <view class=\"social-item\" @click=\"onPhoneLogin\">\r\n            <text class=\"social-icon\">üì±</text>\r\n            <text class=\"social-text\">ÊâãÊú∫ÁôªÂΩï</text>\r\n          </view>\r\n        </view>\r\n      </view>\r\n      \r\n      <!-- Ê≥®ÂÜåÈìæÊé• -->\r\n      <view class=\"register-section\">\r\n        <text class=\"register-text\">ËøòÊ≤°ÊúâË¥¶Âè∑Ôºü</text>\r\n        <text class=\"register-link\" @click=\"goToRegister\">Á´ãÂç≥Ê≥®ÂÜå</text>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, reactive, onMounted } from 'vue'\r\nimport { useUserStore } from '../../stores/user'\r\nimport { isWechatEnv, isWechatMiniProgram } from '../../utils/wechat'\r\n\r\n// Áî®Êà∑store\r\nconst userStore = useUserStore()\r\n\r\n// ÂìçÂ∫îÂºèÊï∞ÊçÆ\r\nconst loading = ref(false)\r\nconst showPassword = ref(false)\r\nconst isWechat = ref(false)\r\nconst isMiniProgram = ref(false)\r\n\r\nconst formData = reactive({\r\n  username: '',\r\n  password: '',\r\n  remember: false\r\n})\r\n\r\n// ËÆ°ÁÆóÂ±ûÊÄß\r\nconst canLogin = computed(() => {\r\n  return formData.username.trim() && formData.password.trim()\r\n})\r\n\r\n// ÁîüÂëΩÂë®Êúü\r\nonMounted(() => {\r\n  checkEnvironment()\r\n})\r\n\r\n// Ê£ÄÊµãÂΩìÂâçÁéØÂ¢É\r\nconst checkEnvironment = () => {\r\n  isWechat.value = isWechatEnv()\r\n  isMiniProgram.value = isWechatMiniProgram()\r\n  \r\n  console.log('ÂΩìÂâçÁéØÂ¢É:', {\r\n    isWechat: isWechat.value,\r\n    isMiniProgram: isMiniProgram.value\r\n  })\r\n  \r\n  // Â¶ÇÊûúÊòØÂæÆ‰ø°Â∞èÁ®ãÂ∫èÔºåÂèØ‰ª•Â∞ùËØïËá™Âä®ÁôªÂΩï\r\n  if (isMiniProgram.value) {\r\n    // Ê£ÄÊü•ÊòØÂê¶ÊúâÊúâÊïàÁöÑÁôªÂΩïÁä∂ÊÄÅ\r\n    if (userStore.checkLoginStatus()) {\r\n      // Ëá™Âä®Ë∑≥ËΩ¨Âà∞È¶ñÈ°µ\r\n      setTimeout(() => {\r\n        uni.reLaunch({\r\n          url: '/pages/index/index'\r\n        })\r\n      }, 1000)\r\n    }\r\n  }\r\n}\r\n\r\n// ÂàáÊç¢ÂØÜÁ†ÅÊòæÁ§∫\r\nconst togglePassword = () => {\r\n  showPassword.value = !showPassword.value\r\n}\r\n\r\n// ËÆ∞‰ΩèÂØÜÁ†ÅÂèòÂåñ\r\nconst onRememberChange = (e) => {\r\n  formData.remember = e.detail.value\r\n}\r\n\r\n// ÂøòËÆ∞ÂØÜÁ†Å\r\nconst onForgotPassword = () => {\r\n  uni.showToast({\r\n    title: 'ËØ∑ËÅîÁ≥ªÁÆ°ÁêÜÂëòÈáçÁΩÆÂØÜÁ†Å',\r\n    icon: 'none'\r\n  })\r\n}\r\n\r\n// ÂæÆ‰ø°ÁôªÂΩï\r\nconst onWechatLogin = async () => {\r\n  try {\r\n    loading.value = true\r\n    \r\n    // Ë∞ÉÁî®ÂæÆ‰ø°ÁôªÂΩï\r\n    await userStore.wechatLogin()\r\n    \r\n    // ÁôªÂΩïÊàêÂäüÊèêÁ§∫\r\n    uni.showToast({\r\n      title: 'ÂæÆ‰ø°ÁôªÂΩïÊàêÂäü',\r\n      icon: 'success'\r\n    })\r\n    \r\n    // Ë∑≥ËΩ¨Âà∞È¶ñÈ°µ\r\n    setTimeout(() => {\r\n      uni.reLaunch({\r\n        url: '/pages/index/index'\r\n      })\r\n    }, 1500)\r\n    \r\n  } catch (error) {\r\n    console.error('ÂæÆ‰ø°ÁôªÂΩïÂ§±Ë¥•:', error)\r\n    uni.showToast({\r\n      title: error.message || 'ÂæÆ‰ø°ÁôªÂΩïÂ§±Ë¥•ÔºåËØ∑ÈáçËØï',\r\n      icon: 'none'\r\n    })\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// ÊâãÊú∫ÁôªÂΩï\r\nconst onPhoneLogin = () => {\r\n  uni.showToast({\r\n    title: 'ÊâãÊú∫ÁôªÂΩïÂäüËÉΩÂºÄÂèë‰∏≠',\r\n    icon: 'none'\r\n  })\r\n}\r\n\r\n// Ë∑≥ËΩ¨Ê≥®ÂÜå\r\nconst goToRegister = () => {\r\n  uni.showToast({\r\n    title: 'Ê≥®ÂÜåÂäüËÉΩÂºÄÂèë‰∏≠',\r\n    icon: 'none'\r\n  })\r\n}\r\n\r\n// Â§ÑÁêÜÁôªÂΩï\r\nconst handleLogin = async () => {\r\n  if (!canLogin.value || loading.value) return\r\n  \r\n  try {\r\n    loading.value = true\r\n    \r\n    // Ë∞ÉÁî®ÁôªÂΩïAPI\r\n    await userStore.login({\r\n      username: formData.username.trim(),\r\n      password: formData.password\r\n    })\r\n    \r\n    // ÁôªÂΩïÊàêÂäüÊèêÁ§∫\r\n    uni.showToast({\r\n      title: 'ÁôªÂΩïÊàêÂäü',\r\n      icon: 'success'\r\n    })\r\n    \r\n    // Ë∑≥ËΩ¨Âà∞È¶ñÈ°µ\r\n    setTimeout(() => {\r\n      uni.reLaunch({\r\n        url: '/pages/index/index'\r\n      })\r\n    }, 1500)\r\n    \r\n  } catch (error) {\r\n    console.error('ÁôªÂΩïÂ§±Ë¥•:', error)\r\n    uni.showToast({\r\n      title: error.message || 'ÁôªÂΩïÂ§±Ë¥•ÔºåËØ∑ÈáçËØï',\r\n      icon: 'none'\r\n    })\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.login-container {\r\n  min-height: 100vh;\r\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n  padding: 40rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.logo-section {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  margin-bottom: 80rpx;\r\n}\r\n\r\n.logo {\r\n  width: 160rpx;\r\n  height: 160rpx;\r\n  margin-bottom: 40rpx;\r\n}\r\n\r\n.app-name {\r\n  font-size: 48rpx;\r\n  font-weight: bold;\r\n  color: #ffffff;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.app-desc {\r\n  font-size: 28rpx;\r\n  color: rgba(255, 255, 255, 0.8);\r\n}\r\n\r\n.form-section {\r\n  background: #ffffff;\r\n  border-radius: 24rpx;\r\n  padding: 60rpx 40rpx;\r\n  box-shadow: 0 20rpx 40rpx rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.form-item {\r\n  margin-bottom: 40rpx;\r\n}\r\n\r\n.input-wrapper {\r\n  position: relative;\r\n  display: flex;\r\n  align-items: center;\r\n  background: #f8f9fa;\r\n  border-radius: 16rpx;\r\n  padding: 0 30rpx;\r\n  border: 2rpx solid transparent;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.input-wrapper:focus-within {\r\n  border-color: #007AFF;\r\n  background: #ffffff;\r\n}\r\n\r\n.icon {\r\n  font-size: 32rpx;\r\n  margin-right: 20rpx;\r\n  color: #6c757d;\r\n}\r\n\r\n.input {\r\n  flex: 1;\r\n  height: 88rpx;\r\n  font-size: 32rpx;\r\n  color: #333333;\r\n}\r\n\r\n.eye-icon {\r\n  font-size: 32rpx;\r\n  color: #6c757d;\r\n  padding: 20rpx;\r\n  cursor: pointer;\r\n}\r\n\r\n.remember-section {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 40rpx;\r\n}\r\n\r\n.remember-item {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.remember-text {\r\n  font-size: 28rpx;\r\n  color: #666666;\r\n  margin-left: 16rpx;\r\n}\r\n\r\n.forgot-password {\r\n  font-size: 28rpx;\r\n  color: #007AFF;\r\n  cursor: pointer;\r\n}\r\n\r\n.login-btn {\r\n  width: 100%;\r\n  height: 88rpx;\r\n  background: linear-gradient(135deg, #007AFF 0%, #0056CC 100%);\r\n  color: #ffffff;\r\n  border: none;\r\n  border-radius: 16rpx;\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  margin-bottom: 40rpx;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.login-btn:disabled {\r\n  background: #cccccc;\r\n  opacity: 0.6;\r\n}\r\n\r\n.login-btn:not(:disabled):active {\r\n  transform: scale(0.98);\r\n}\r\n\r\n.other-login {\r\n  text-align: center;\r\n  margin-bottom: 40rpx;\r\n}\r\n\r\n.divider {\r\n  font-size: 24rpx;\r\n  color: #999999;\r\n  margin-bottom: 30rpx;\r\n  display: block;\r\n}\r\n\r\n.social-login {\r\n  display: flex;\r\n  justify-content: center;\r\n  gap: 60rpx;\r\n}\r\n\r\n.social-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  cursor: pointer;\r\n}\r\n\r\n.social-icon {\r\n  font-size: 48rpx;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.social-text {\r\n  font-size: 24rpx;\r\n  color: #666666;\r\n}\r\n\r\n.register-section {\r\n  text-align: center;\r\n}\r\n\r\n.register-text {\r\n  font-size: 28rpx;\r\n  color: #666666;\r\n}\r\n\r\n.register-link {\r\n  font-size: 28rpx;\r\n  color: #007AFF;\r\n  margin-left: 16rpx;\r\n  cursor: pointer;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/Users/Administrator/Desktop/shopkeeper6/zgt-app/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["useUserStore","ref","reactive","computed","onMounted","isWechatEnv","isWechatMiniProgram","uni"],"mappings":"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"}